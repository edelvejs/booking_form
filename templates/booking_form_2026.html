<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Бронювання путівки</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; }
    h2 { color: #333; }
    label { display: block; margin-top: 10px; }
    input, select { width: 100%; padding: 8px; margin-top: 4px; }
    button { margin-top: 20px; padding: 10px 20px; }
    #cost-display { margin-top: 10px; font-weight: bold; color: #006400; }
  </style>
</head>
<body>
  <h2>1. Персональні дані</h2>
  <form id="bookingForm">
    <label>ПІБ дитини <input type="text" name="child_name" required></label>
    <label>ПІБ батьків <input type="text" name="parent_name" required></label>
    <label>Телефон <input type="tel" name="phone" required></label>
    <label>Email <input type="email" name="email"></label>
    <label>Адреса <input type="text" name="address"></label>
    <label>Дата народження <input type="date" name="dob"></label>
    <label>Паспорт/Свідоцтво <input type="text" name="id_doc"></label>
    <label>Примітки <input type="text" name="notes"></label>

    <h2>2. Вибір супроводу</h2>
    <label>Табір
      <select name="dot" id="dot-select">
        <option>Едельвейс</option>
        <option>Сонячний</option>
        <option>Морський</option>
      </select>
    </label>
    <label>Зміна
      <select name="shift">
        <option>1 (01.06–14.06)</option>
        <option>2 (15.06–28.06)</option>
        <option>3 (29.06–12.07)</option>
      </select>
    </label>
    <label>Маршрут
      <select name="route" id="route-select">
        <option value="Київ-ДОТ-Київ">Київ-ДОТ-Київ</option>
        <option value="Київ-ДОТ">Київ-ДОТ</option>
        <option value="ДОТ-Київ">ДОТ-Київ</option>
        <option value="Дніпро-ДОТ-Дніпро">Дніпро-ДОТ-Дніпро</option>
        <option value="Дніпро-ДОТ">Дніпро-ДОТ</option>
        <option value="ДОТ-Дніпро">ДОТ-Дніпро</option>
        <option value="Харків-ДОТ-Харків">Харків-ДОТ-Харків</option>
        <option value="Харків-ДОТ">Харків-ДОТ</option>
        <option value="ДОТ-Харків">ДОТ-Харків</option>
      </select>
    </label>

    <div id="cost-display">Вартість: <span id="cost-value">-</span> грн</div>

    <button type="submit">Надіслати</button>
    <button type="button" onclick="generatePDF()">Отримати рахунок</button>
  </form>

  <script>
    const routeCosts = {
      "Київ-ДОТ-Київ": 2000,
      "Київ-ДОТ": 1700,
      "ДОТ-Київ": 1700,
      "Дніпро-ДОТ-Дніпро": 3100,
      "Дніпро-ДОТ": 2300,
      "ДОТ-Дніпро": 2300,
      "Харків-ДОТ-Харків": 4200,
      "Харків-ДОТ": 3100,
      "ДОТ-Харків": 3100
    };

    const dotCosts = {
      "Едельвейс": 23700,
      "Сонячний": 22700,
      "Морський": 21900
    };

    const routeSelect = document.getElementById("route-select");
    const dotSelect = document.getElementById("dot-select");
    const costValue = document.getElementById("cost-value");

    function updateTotalCost() {
      const route = routeSelect.value;
      const dot = dotSelect.value;
      const transferCost = routeCosts[route] || 0;
      const dotCost = dotCosts[dot] || 0;
      const total = transferCost + dotCost;
      costValue.textContent = total;
    }

    routeSelect.addEventListener("change", updateTotalCost);
    dotSelect.addEventListener("change", updateTotalCost);

    function generatePDF() {
      const form = document.getElementById('bookingForm');
      const data = new FormData(form);
      const doc = new jspdf.jsPDF();

      const route = data.get("route");
      const dot = data.get("dot");
      const transferCost = routeCosts[route] || 0;
      const dotCost = dotCosts[dot] || 0;
      const totalCost = transferCost + dotCost;

      doc.setFontSize(14);
      doc.text("Рахунок на оплату", 20, 20);

      let y = 30;
      for (const [key, value] of data.entries()) {
        doc.text(`${key}: ${value}`, 20, y);
        y += 10;
      }

      doc.text(`Вартість табору: ${dotCost} грн`, 20, y); y += 10;
      doc.text(`Вартість трансферу: ${transferCost} грн`, 20, y); y += 10;
      doc.text(`Загальна вартість: ${totalCost} грн`, 20, y);

      doc.save("рахунок.pdf");
    }

    document.addEventListener("keydown", function(event) {
      if (event.ctrlKey && event.key === "r") {
        event.preventDefault();
        generatePDF();
      }
    });

    updateTotalCost(); // розрахунок при завантаженні
  </script>
</body>
</html>
